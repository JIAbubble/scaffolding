# æ ¸å¿ƒåŠŸèƒ½å®ç°æ€»ç»“

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### 1. å…¨å±€å¼‚å¸¸å¤„ç†å™¨ âœ…

**æ–‡ä»¶ä½ç½®**ï¼š`src/main/java/com/example/performanceevaluation/exception/GlobalExceptionHandler.java`

**åŠŸèƒ½**ï¼š
- ç»Ÿä¸€å¤„ç†æ‰€æœ‰å¼‚å¸¸
- è¿”å›ç»Ÿä¸€çš„é”™è¯¯å“åº”æ ¼å¼
- æ”¯æŒå¤šç§å¼‚å¸¸ç±»å‹ï¼ˆä¸šåŠ¡å¼‚å¸¸ã€å‚æ•°å¼‚å¸¸ã€æ ¡éªŒå¼‚å¸¸ç­‰ï¼‰

**ä½¿ç”¨æ–¹å¼**ï¼š
```java
throw new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨");
// è‡ªåŠ¨è¿”å›ï¼š{"code": 400, "status": false, "message": "ç”¨æˆ·ä¸å­˜åœ¨"}
```

---

### 2. ç»Ÿä¸€å“åº”åŒ…è£…å™¨ âœ…

**æ–‡ä»¶ä½ç½®**ï¼š`src/main/java/com/example/performanceevaluation/config/GlobalResponseBodyAdvice.java`

**åŠŸèƒ½**ï¼š
- è‡ªåŠ¨å°†Controllerè¿”å›å€¼åŒ…è£…ä¸ºResponseResultæ ¼å¼
- æ”¯æŒæ‰€æœ‰è¿”å›ç±»å‹ï¼ˆObjectã€Listã€Stringç­‰ï¼‰
- å¦‚æœå·²ç»è¿”å›ResponseResultï¼Œä¸ä¼šé‡å¤åŒ…è£…

**ä½¿ç”¨æ–¹å¼**ï¼š
```java
@GetMapping("/{id}")
public User getUser(@PathVariable Long id) {
    return userService.getById(id);
    // è‡ªåŠ¨åŒ…è£…ä¸ºï¼š{"code": 200, "status": true, "message": "æ“ä½œæˆåŠŸ", "data": {...}}
}
```

---

### 3. è‡ªå®šä¹‰å¼‚å¸¸ç±» âœ…

**æ–‡ä»¶ä½ç½®**ï¼š
- `src/main/java/com/example/performanceevaluation/exception/BusinessException.java`
- `src/main/java/com/example/performanceevaluation/exception/ParameterException.java`

**åŠŸèƒ½**ï¼š
- BusinessExceptionï¼šä¸šåŠ¡å¼‚å¸¸
- ParameterExceptionï¼šå‚æ•°å¼‚å¸¸ï¼ˆæ”¯æŒå¤šä¸ªé”™è¯¯ä¿¡æ¯ï¼‰

**ä½¿ç”¨æ–¹å¼**ï¼š
```java
// ä¸šåŠ¡å¼‚å¸¸
throw new BusinessException(ResultCode.DATA_NOT_EXIST, "ç”¨æˆ·ä¸å­˜åœ¨");

// å‚æ•°å¼‚å¸¸
throw new ParameterException("å‚æ•°æ ¡éªŒå¤±è´¥", errors);
```

---

### 4. å¤šç¯å¢ƒé…ç½® âœ…

**æ–‡ä»¶ä½ç½®**ï¼š
- `src/main/resources/application.yml`ï¼ˆä¸»é…ç½®ï¼‰
- `src/main/resources/application-dev.yml`ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
- `src/main/resources/application-test.yml`ï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰
- `src/main/resources/application-prod.yml`ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

**åŠŸèƒ½**ï¼š
- ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒé…ç½®
- æ•°æ®åº“è¿æ¥ã€æ—¥å¿—çº§åˆ«ã€Swaggerç­‰å¯åˆ†åˆ«é…ç½®

**ä½¿ç”¨æ–¹å¼**ï¼š
```bash
# å¯åŠ¨æ—¶æŒ‡å®šç¯å¢ƒ
java -jar app.jar --spring.profiles.active=prod
```

---

### 5. è¯·æ±‚æ—¥å¿—æ‹¦æˆªå™¨ âœ…

**æ–‡ä»¶ä½ç½®**ï¼š
- `src/main/java/com/example/performanceevaluation/interceptor/LoggingInterceptor.java`
- `src/main/java/com/example/performanceevaluation/config/CorsConfig.java`ï¼ˆå·²æ›´æ–°ï¼Œæ³¨å†Œæ‹¦æˆªå™¨ï¼‰

**åŠŸèƒ½**ï¼š
- è‡ªåŠ¨è®°å½•æ‰€æœ‰HTTPè¯·æ±‚å’Œå“åº”
- è®°å½•è¯·æ±‚æ–¹æ³•ã€URIã€å‚æ•°ã€å“åº”çŠ¶æ€ç ã€è€—æ—¶ç­‰
- æ”¯æŒDEBUGå’ŒINFOä¸¤ç§æ—¥å¿—çº§åˆ«

**æ—¥å¿—è¾“å‡º**ï¼š
- DEBUGçº§åˆ«ï¼šå®Œæ•´çš„è¯·æ±‚å’Œå“åº”ä¿¡æ¯
- INFOçº§åˆ«ï¼šå…³é”®ä¿¡æ¯ï¼ˆæ–¹æ³•ã€URIã€çŠ¶æ€ç ã€è€—æ—¶ï¼‰

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
src/main/java/com/example/performanceevaluation/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ CorsConfig.java                    # å·²æ›´æ–°ï¼šæ·»åŠ æ‹¦æˆªå™¨æ³¨å†Œ
â”‚   â”œâ”€â”€ GlobalResponseBodyAdvice.java       # æ–°å¢ï¼šç»Ÿä¸€å“åº”åŒ…è£…å™¨
â”‚   â”œâ”€â”€ MybatisPlusConfig.java
â”‚   â””â”€â”€ OpenApiConfig.java
â”œâ”€â”€ controller/
â”‚   â””â”€â”€ UserController.java                # å·²æ›´æ–°ï¼šä½¿ç”¨æ–°å¼‚å¸¸å¤„ç†
â”œâ”€â”€ exception/
â”‚   â”œâ”€â”€ BusinessException.java             # æ–°å¢ï¼šä¸šåŠ¡å¼‚å¸¸
â”‚   â”œâ”€â”€ GlobalExceptionHandler.java        # æ–°å¢ï¼šå…¨å±€å¼‚å¸¸å¤„ç†å™¨
â”‚   â””â”€â”€ ParameterException.java            # æ–°å¢ï¼šå‚æ•°å¼‚å¸¸
â””â”€â”€ interceptor/
    â””â”€â”€ LoggingInterceptor.java            # æ–°å¢ï¼šè¯·æ±‚æ—¥å¿—æ‹¦æˆªå™¨

src/main/resources/
â”œâ”€â”€ application.yml                         # å·²æ›´æ–°ï¼šæ·»åŠ ç¯å¢ƒé…ç½®
â”œâ”€â”€ application-dev.yml                    # æ–°å¢ï¼šå¼€å‘ç¯å¢ƒé…ç½®
â”œâ”€â”€ application-test.yml                   # æ–°å¢ï¼šæµ‹è¯•ç¯å¢ƒé…ç½®
â””â”€â”€ application-prod.yml                   # æ–°å¢ï¼šç”Ÿäº§ç¯å¢ƒé…ç½®
```

---

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### Controllerç¤ºä¾‹

```java
@RestController
@RequestMapping("/api/users")
@RequiredArgsConstructor
public class UserController {
    
    private final UserService userService;
    
    @GetMapping("/{id}")
    // è¿”å›å€¼ä¼šè‡ªåŠ¨åŒ…è£…ä¸ºResponseResult<User>
    // å¼‚å¸¸ä¼šè‡ªåŠ¨è¢«GlobalExceptionHandlerå¤„ç†
    public User getUser(@PathVariable Long id) {
        User user = userService.getById(id);
        if (user == null) {
            throw new BusinessException(ResultCode.DATA_NOT_EXIST, "ç”¨æˆ·ä¸å­˜åœ¨");
        }
        return user;
    }
}
```

### Serviceç¤ºä¾‹

```java
@Service
public class UserService {
    
    public User getById(Long id) {
        User user = this.getById(id);
        if (user == null) {
            throw new BusinessException(ResultCode.DATA_NOT_EXIST, "ç”¨æˆ·ä¸å­˜åœ¨");
        }
        return user;
    }
}
```

---

## ğŸ”§ é…ç½®è¯´æ˜

### æ¿€æ´»ç¯å¢ƒ

åœ¨ `application.yml` ä¸­ï¼š
```yaml
spring:
  profiles:
    active: dev  # é»˜è®¤å¼€å‘ç¯å¢ƒ
```

æˆ–å¯åŠ¨å‚æ•°ï¼š
```bash
java -jar app.jar --spring.profiles.active=prod
```

### æ—¥å¿—çº§åˆ«

åœ¨ `application.yml` ä¸­ï¼š
```yaml
logging:
  level:
    com.example.performanceevaluation.interceptor: debug  # å®Œæ•´æ—¥å¿—
    # æˆ–
    com.example.performanceevaluation.interceptor: info   # ç®€åŒ–æ—¥å¿—
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨è¯´æ˜.md](./æ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨è¯´æ˜.md) - è¯¦ç»†ä½¿ç”¨æ–‡æ¡£
- [è„šæ‰‹æ¶å®Œå–„æ¸…å•.md](./è„šæ‰‹æ¶å®Œå–„æ¸…å•.md) - åŠŸèƒ½æ¸…å•

---

## âœ¨ ç‰¹æ€§

1. **è‡ªåŠ¨å¼‚å¸¸å¤„ç†**ï¼šæ‰€æœ‰å¼‚å¸¸è‡ªåŠ¨ç»Ÿä¸€å¤„ç†ï¼Œæ— éœ€æ‰‹åŠ¨try-catch
2. **è‡ªåŠ¨å“åº”åŒ…è£…**ï¼šControllerè¿”å›å€¼è‡ªåŠ¨åŒ…è£…ï¼Œæ— éœ€æ‰‹åŠ¨åˆ›å»ºResponseResult
3. **å®Œæ•´æ—¥å¿—è®°å½•**ï¼šæ‰€æœ‰è¯·æ±‚è‡ªåŠ¨è®°å½•ï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§
4. **å¤šç¯å¢ƒæ”¯æŒ**ï¼šè½»æ¾åˆ‡æ¢å¼€å‘/æµ‹è¯•/ç”Ÿäº§ç¯å¢ƒ
5. **ç±»å‹å®‰å…¨**ï¼šè‡ªå®šä¹‰å¼‚å¸¸ç±»ï¼Œç±»å‹å®‰å…¨

---

**æ‰€æœ‰åŠŸèƒ½å·²å®ç°å¹¶é›†æˆï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼** ğŸ‰

